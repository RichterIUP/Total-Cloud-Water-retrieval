<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>L-IWP: How to install L-IWP</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">L-IWP
   &#160;<span id="projectnumber">0.9beta</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">How to install L-IWP </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>1. Download source codes:</h2>
<ul>
<li><a href="http://rtweb.aer.com/lblrtm.html">LBLRTM</a></li>
<li><a href="https://www.nssl.noaa.gov/users/dturner/public_html/lbldis/index.html">DISORT (LBLDIS)</a></li>
<li>L-IWP: git clone <a href="https://github.com/RichterIUP/L-IWP.git">https://github.com/RichterIUP/L-IWP.git</a></li>
</ul>
<h2>2. LBLRTM:</h2>
<ul>
<li>Extract the source code: <div class="fragment"><div class="line">&gt; tar -xzvf aer_lblrtm_v12.8.tar.gz</div></div><!-- fragment --></li>
</ul>
<p>LBLRTM requires a spectroscopic database. There are two ways to deal with this:</p>
<p>2.1 Set up the database on your own. To do so, one needs to extract LNFL and the HITRAN database. Next, lnfl needs to be compiled and then the database can be created </p><div class="fragment"><div class="line">&gt; tar -xzvf lnfl_v3.1.tar.gz</div><div class="line">&gt; tar -xzvf aer_v_3.6.tar.gz </div><div class="line">&gt; make -f make_lnfl linuxGNUsgl</div><div class="line">&gt; cd ../../aer_v_3.6/line_file</div><div class="line">&gt; ../../lnfl/lnfl_v3.1_linux_gnu_sgl</div></div><!-- fragment --><p>2.2 Use the file TAPE3.10-3500cm-1.first_7_molecules</p>
<ul>
<li>Create lblrtm/hitran and place the following files: <div class="fragment"><div class="line">&gt; ln -s path/to/TAPE3/file/TAPE3.10-3500.cm-1.first_7_molecules ./tape3.data</div><div class="line">&gt; ln -s ../run_examples/xs_files/xs ./xs</div><div class="line">&gt; ln -s ../run_examples/xs_files/xs ./x</div><div class="line">&gt; ln -s ../run_examples/xs_files/FSCDXS ./FSCDXS</div></div><!-- fragment --></li>
<li>Compile LBLRTM <div class="fragment"><div class="line">&gt; cd lblrtm/build</div><div class="line">&gt; make -f make_lblrtm linuxGNUsgl</div></div><!-- fragment --> Maybe there could be some errors. Then you should fix the bugs. First bug seems to be in lblatm.f90, line 7967. Insert a whitespace between STOP and the string.</li>
<li>Create the folder lblrtm/bin and link the binary <div class="fragment"><div class="line">&gt; mkdir lblrtm/bin</div><div class="line">&gt; ln -s ../lblrtm_v12.8_linux_gnu_sgl ./lblrtm</div></div><!-- fragment --></li>
</ul>
<h2>3. LBLDIS:</h2>
<ul>
<li>Create folder lbldis and copy the archive into it. Extract the archive: <div class="fragment"><div class="line">&gt; mkdir lbldis</div><div class="line">&gt; cd lbldis</div><div class="line">&gt; tar -xvf lbldis.Release_3_0.tar </div><div class="line">&gt; chmod +w *</div></div><!-- fragment --></li>
<li>By default, LBLDIS wants to be compiled using IFORT. If you want to use GFORTRAN, then change following lines in Makefile: <div class="fragment"><div class="line">- Line 20: Change ifort to gfortran</div><div class="line">- Line 26: Remove -nofor_main</div><div class="line">- Line 120 and 129: Change -r8 to -fdefault-real-8 -fdefault-double-8</div></div><!-- fragment --></li>
<li>Compile the source <div class="fragment"><div class="line">&gt; make</div></div><!-- fragment --></li>
</ul>
<h2>4. L-IWP:</h2>
<ul>
<li>Set the paths in inp.py: <div class="fragment"><div class="line">path = path/to/retrieval/output</div><div class="line">outfolder = path/to/results/output</div><div class="line">exec_lbldis = &#39;(path/to/lbldis/binary {}/.lbldis_{}.parm 0 {}) &gt;&amp; {}\n&#39;</div><div class="line">path_to_lblrtm = &#39;path/to/lblrtm/main/folder&#39; (not to the bin-folder!)</div></div><!-- fragment --></li>
</ul>
<h2>5. Create virtual environment for Python 3</h2>
<p>If you don't want to 'contaminate' your local Python, you can create a virtual environment</p>
<div class="fragment"><div class="line">&gt; sudo apt-get install python3-venv</div><div class="line">&gt; python3 -m venv path/to/python/virtenv</div><div class="line">&gt; source path/to/python/virtenv/bin/activate</div><div class="line">&gt; path/to/python/virtenv/bin/pip3 install numpy</div><div class="line">&gt; path/to/python/virtenv/bin/pip3 install scipy</div><div class="line">&gt; path/to/python/virtenv/bin/pip3 install matplotlib</div><div class="line">&gt; path/to/python/virtenv/bin/pip3 install netcdf4</div></div><!-- fragment --><h2>6. Test installation:</h2>
<ul>
<li>Go to L-IWP and run liwp_main.py <div class="fragment"><div class="line">path/to/python/virtenv/bin/python3 liwp_main.py </div></div><!-- fragment --> </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
